---
title: "RHomework3"
author: "Sadiq Rahman"
date: "24/02/2021"
output: html_document
---


```{r message = FALSE}
library(tidyverse)
library(factoextra)
```

```{r message = FALSE, warning = FALSE}
stroop <- read_csv("stroop_standing_data.csv")
```

The data in it's current form is *very* messy.
We can start by mutating reaction time to a numerical value, not a categorical value.
By doing so, we can  omit all data where RT was not recorded (rt = FALSE)

```{r, warning = FALSE}
stroop <- mutate(stroop, rt = as.numeric(rt))
stroop <- filter(stroop, rt > 0)
```

Then, we omit all practice trials.

```{r}
stroop <- filter(stroop, phase != "practice")
```

Next, we omit all mistrials (correct = 999).

```{r}
stroop <- filter(stroop, correct < 2)
```

Finally, by changing the variable X11 to numeric (from logical) we can see that it is simply a copy of RT.
We can proceed by omitting the whole column as it is unnecassary. We now have uncluttered, understandable data.

```{r}
stroop <- mutate(stroop, X11 = as.numeric(X11))
stroop <- stroop[,-11]
```

```{r message = FALSE}
stroop %>%
group_by(phase, congruency, subject) %>%
summarise(
rt = mean(rt),
n = n(),
proportion = mean(correct)) %>%
glimpse() -> summary_stroop
```

By grouping by phase (sitting or standing) and congruency (baseline, congruent, and incongruent), 
we can look at the mean reaction time in each group. What we find is the incongruent group 
take longer to react than the congruent and baseline condition. There doesn't appear to be a significant
effect of phase on reaction time, congruency, or proportion correct.

```{r}
boxplot(rt ~ congruency, summary_stroop)
```

The boxplot shows that the on average, the reaction time in the congruent and the baseline condition are practically the same.
Incongruent shows the greatest reaction time, as expected. The variance across the three condition appears similar.

A linear model can determine whether there is a significant difference in reaction time between participants
who were standing vs sitting. 

```{r}
stroop_phase <- lm(rt ~ phase, stroop)
summary(stroop_phase)
```

Model reveals no significant difference in reaction time between those standing and those sitting (p > 0.05).

We can then look on the influence on whether starting trials sitting or standing can have influence reaction time.

```{r}
stroop_condition <- lm(rt ~ condition, stroop)
summary(stroop_condition)
```


Linking this back to the original study which found a smaller stroop effect when participants performed the task standing than when sitting (i.e, greater stroop effect when sitting than when standing, so greater reaction time when sitting versus standing), the replication study found no significant difference in the stroop effect whether participants were standing or when they were sitting.
The replication study did however, find a significant difference in the stroop effect depending on whether participants started
sitting down or standing up. Participants showed significant lower reaction time if they started sitting (rt = 819) 
compared to participants who started standing (rt = 819 + 22 = 841; p < .05).

```{r, message=FALSE, warning=FALSE}
Spotify <- read_csv("All-About-the-Music/Spotifier/data/spotify_cleaned.csv")
```

First we can start by removing all information that is not relevant to our replication.

```{r}
Spotify <- select(Spotify, -key, -mode, -speechiness, -instrumentalness, -liveness, -time_signature, -duration_sec, -X1, -"Track Name", -Artist, -Streams)
```

Now we can run a PCA.

```{r}
PCA <- prcomp(Spotify)
summary(PCA)
```

What we find is that 99.9 (practically all) of the variance is explaind by the first 2 dimensions, confirming the findings from the original study.









