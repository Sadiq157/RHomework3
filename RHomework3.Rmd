---
title: "RHomework3"
author: "Sadiq Rahman"
date: "24/02/2021"
output: html_document
---


```{r message = FALSE}
library(tidyverse)
library(factoextra)
```

```{r message = FALSE, warning = FALSE}
stroop <- read_csv("stroop_standing_data.csv")
```

The data in it's current form is *very* messy.
We can start by mutating reaction time to a numerical value, not a categorical value.
By doing so, we can  omit all data where RT was not recorded (rt = FALSE)

```{r, warning = FALSE}
stroop <- mutate(stroop, rt = as.numeric(rt))
stroop <- filter(stroop, rt > 0)
```

Then, we omit all practice trials.

```{r}
stroop <- filter(stroop, phase != "practice")
```

Next, we omit all mistrials (correct = 999).

```{r}
stroop <- filter(stroop, correct < 2)
```

Finally, by changing the variable X11 to numeric (from logical) we can see that it is simply a copy of RT.
We can proceed by omitting the whole column as it is unnecassary. We now have uncluttered, understandable data.

```{r}
stroop <- mutate(stroop, X11 = as.numeric(X11))
stroop <- stroop[,-11]
```

```{r message = FALSE}
stroop %>%
group_by(phase, congruency) %>%
summarise(
rt = mean(rt),
n = n(),
proportion = mean(correct)) %>%
glimpse() -> summary_stroop
```

By grouping by phase (sitting or standing) and congruency (baseline, congruent, and incongruent), 
we can look at the mean reaction time in each group. What we find is the incongruent group 
take longer to react than the congruent and baseline condition. There doesn't appear to be a significant
effect of phase on reaction time, congruency, or proportion correct.

A linear model can determine whether there is a significant difference in reaction time between participants
who were standing vs sitting. 

```{r}
stroop_phase <- lm(rt ~ phase, stroop)
summary(stroop_phase)
```

Model reveals no significant difference in reaction time between those standing and those sitting (p > 0.05).

We can then look on the influence on whether starting trials sitting or standing can have influence reaction time.

```{r}
stroop_condition <- lm(rt ~ condition, stroop)
summary(stroop_condition)
```


Linking this back to the original study which found a smaller stroop effect when participants performed the task standing than when sitting (i.e, greater stroop effect when sitting than when standing, so greater reaction time when sitting versus standing), the replication study found no significant difference in the stroop effect whether participants were standing or when they were sitting.
The replication study did however, find a significant difference in the stroop effect depending on whether participants started
sitting down or standing up. Participants showed significant lower reaction time if they started sitting (rt = 819) 
compared to participants who started standing (rt = 819 + 22 = 841; p < .05).

```{r, warning = FALSE, message = FALSE}
Spotify <- read_csv("regional-global-daily-latest.csv")
```

Data is very messy - we can start by elimating the URL. 

```{r}
Spotify <- Spotify %>%
  select(-X5)
```

We can then rename the columns to something more useful than X1, X2 ...

```{r}
names(Spotify)[1] <- "Position"
names(Spotify)[2] <- "Track Name"
names(Spotify)[3] <- "Artist"
names(Spotify)[4] <- "Streams"
```

Finally, we can remove the first row as it simply repeats our column names

```{r}
Spotify <- Spotify[-1,]
```

The Spotify data is currently all categorical. To do a PCA, we would need to change our categories of interest to numeric.
We would also need to remove categories which are not of interest.

```{r}
Spotify <- select(Spotify, -Artist, -'Track Name')
Spotify <- mutate(Spotify, Position = as.numeric(Position), 
                  Streams = as.numeric(Streams))
PCA <- prcomp(Spotify)
summary(PCA)
fviz_pca_var(PCA)
```

What we can see is that Position explains 100% of the variance. The writer is correct, as 99% of the variance can be explained with two
dimensions, but at the same time, the author is wrong as it only required one dimension to explain 100% of the variance.
The second dimension (Streams) did not contribute to the variance.












