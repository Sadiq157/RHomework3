---
title: "RHomework3"
author: "Sadiq Rahman"
date: "24/02/2021"
output: html_document
---


```{r message = FALSE}
library(tidyverse)
library(factoextra)
```

```{r message = FALSE, warning = FALSE}
stroop <- read_csv("stroop_standing_data.csv")
```

The data in it's current form is *very* messy.
We can start by mutating reaction time to a numerical value, not a categorical value.
By doing so, we can  omit all data where RT was not recorded (rt = FALSE)

```{r, warning = FALSE}
stroop <- mutate(stroop, rt = as.numeric(rt))
stroop <- filter(stroop, rt > 0)
```

Then, we omit all practice trials.

```{r}
stroop <- filter(stroop, phase != "practice")
```

Next, we omit all mistrials (correct = 999).

```{r}
stroop <- filter(stroop, correct < 2)
```

Finally, by changing the variable X11 to numeric (from logical) we can see that it is simply a copy of RT.
We can proceed by omitting the whole column as it is unnecassary. We now have uncluttered, understandable data.

```{r}
stroop <- mutate(stroop, X11 = as.numeric(X11))
stroop <- stroop[,-11]
```

```{r message = FALSE}
stroop %>%
group_by(phase, congruency) %>%
summarise(
rt = mean(rt),
n = n(),
proportion = mean(correct)) %>%
glimpse() -> summary_stroop
```

By grouping by phase (sitting or standing) and congruency (baseline, congruent, and incongruent), 
we can look at the mean reaction time in each group. What we find is the incongruent group 
take longer to react than the congruent and baseline condition. There doesn't appear to be a significant
effect of phase on reaction time, congruency, or proportion correct.

```{r}
boxplot(rt ~ congruency, stroop)
```

The boxplot shows that the on average, the reaction time in the congruent and the baseline condition are practically the same. The variance
for these two conditions are also very similar. The incongruent coondition shows the greatest reaction time, as expected. It also shows the greatest variance.

A linear model can determine whether there is a significant difference in reaction time between participants
who were standing vs sitting. 

```{r}
stroop_phase <- lm(rt ~ phase, stroop)
summary(stroop_phase)
```

Model reveals no significant difference in reaction time between those standing and those sitting (p > 0.05).
We can then look on the influence on whether starting trials sitting or standing can have influence reaction time.

```{r}
stroop_condition <- lm(rt ~ condition, stroop)
summary(stroop_condition)
```


Linking this back to the original study which found a smaller stroop effect when participants performed the task standing than when sitting (i.e, greater stroop effect when sitting than when standing, so greater reaction time when sitting versus standing), the replication study found no significant difference in the stroop effect whether participants were standing or when they were sitting.
The replication study did however, find a significant difference in the stroop effect depending on whether participants started
sitting down or standing up. Participants showed significant lower reaction time if they started sitting (rt = 819) 
compared to participants who started standing (rt = 819 + 22 = 841; p < .05).

```{r, message=FALSE, warning=FALSE}
Spotify <- read_csv("All-About-the-Music/Spotifier/data/spotify_cleaned.csv")
```

First we can start by removing all information that is not relevant to our replication.

```{r, message=FALSE, warning=FALSE}
Spotify <- select(Spotify, -time_signature, -X1, -"Track Name", -Artist, -Streams)
```

Now we can run a PCA.

```{r}
PCA <- prcomp(Spotify)
summary(PCA)
fviz_pca_var(PCA)
```

What we find is that 63% of the variance is being explained by the first dimension (Duration_sec), and an additional 35.5% of the variance is being explained by the second dimension (Tempo). ~99.3% of the variance is being explained by the first two dimensions.

One problem is that the variables are not standardised, which could be why duration_sec is explaining majority of the variance. We can standardise all the variable and rurun the PCA.

```{r message=FALSE, warning=FALSE} 
Spotify_s <- mutate(Spotify, 
valence = scale(valence),
acousticness = scale(acousticness),
loudness = scale(loudness),
energy = scale(energy),
danceability = scale(danceability),
tempo = scale(tempo),
duration_sec = scale(duration_sec),
key = scale(key), 
mode = scale(mode),
speechiness = scale(speechiness),
instrumentalness = scale(instrumentalness),
liveness = scale(liveness))
```

```{r}
PCA_s <- prcomp(Spotify_s)
summary(PCA_s)
fviz_pca_var(PCA_s)
```

We now observe much more variance attributed to different dimensions. The first dimension (predominantly Tempo) only explains 19.8% of the variance,
whereas the second dimension (predominantly Loudness) explains 13.3%. To get around the same variance as before (~99%), we would need 11 dimensions. 






